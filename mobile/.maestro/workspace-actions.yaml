appId: com.subroutine.workspace
---
# Test: Workspace Start/Stop/Recover Operations
# Verifies start, stop, and recover buttons work correctly for workspaces

- launchApp:
    clearState: true

# Wait for app to fully load
- extendedWaitUntil:
    visible: "Workspaces"
    timeout: 10000

# If no workspaces exist, the test gracefully handles empty state
- runFlow:
    when:
      visible: "No workspaces yet"
    commands:
      - assertVisible: "Tap + to create one"

# If workspaces exist, test the start/stop buttons
- runFlow:
    when:
      visible:
        text: "SSH:"
    commands:
      # Tap on the workspace card to open detail modal
      - tapOn:
          text: "SSH:"
      # Should see workspace detail modal with logs
      - assertVisible:
          text: "Logs"
          optional: true
      # Close modal if open
      - tapOn:
          text: "Close"
          optional: true

# Test start button if workspace is stopped
- runFlow:
    when:
      visible:
        text: "Start"
    commands:
      - tapOn: "Start"
      # Wait a moment for the action to register
      - extendedWaitUntil:
          visible:
            text: "running|Starting"
          timeout: 5000

# Test stop button if workspace is running
- runFlow:
    when:
      visible:
        text: "Stop"
    commands:
      - tapOn: "Stop"
      # Wait a moment for the action to register
      - extendedWaitUntil:
          visible:
            text: "stopped|Stopping"
          timeout: 5000

# Test recover button if workspace is in error state
- runFlow:
    when:
      visible:
        text: "Recover"
    commands:
      - tapOn: "Recover"
      # Verify recovery confirmation dialog appears
      - assertVisible: "Recover Workspace"
      - assertVisible: "Attempt to recover"
      # Cancel the recovery for now
      - tapOn: "Cancel"
